%%%%%%%%%%%\chapter{検証}port2 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{共有ホスト名}
\label{evaluation:share_host}
同じネットワークにおけるユーザが共有ホスト名を取得するだけでユーザのホ
ストに関する情報が取得できるかを検証する．取得する情報はSMBとmDNSプロ
トコルである，共有ホスト名とMACアドレスである．それらの情報を用いて，ユー
ザの実生活やホストのOS情報，ホストの所有者を推測する．

\subsection{検証手法}
\label{evaluation:share_host:met}
検証手法としては筆者が所属する研究室のネットワークに本検証手法を用いたホストを接続し，
情報を取得し続ける．取得した期間は2009年11月18日から20日の約3日間である．
取得したホスト名をもとに，ユーザのホスト情報や実生活での情報を結びつける．
そして，ホスト名とMACアドレスを結びつけて，リスト化して保存する．

\subsection{設計概要}

\begin{table}
\begin{center}
\caption{共有ホスト名の手法検証の実装環境}
  \vspace{5mm}

\label{tb:share_name}
\begin{tabular}{|c|c|c|c|}
\hline
仕様言語&version&ライブラリ&OS\\
\hline
C言語&4.2.1&libpcap&FreeBSD7.2\\
\hline
PHP&5.3&&MacOSX 10.6.2\\
\hline
\end{tabular}
\end{center}
\end{table}

検証を行うプログラムは表\ref{tb:share_name}で挙げるようにlibpcapによる
パケットキャプチャをC言語で記述する．プロトコル名とポート番号
でNetBIOSとmDNSを判別し，ペイロードからホスト名のみを抽出す
る．NetBIOSは自身の共有ホスト名しか発信しないが，mDNSの場合はホストが持っ
ている共有ホスト名のリストを送信するため，まとめて取得する．SMBの場合は
共有ホスト名とMACアドレスの結びつけは容易であるが，mDNSによるリストから
共有ファイル名を取得した場合は，MACアドレスとの結びつけが難しい．そこで，
リストから共有ファイル名を取得した場合は，リストに記載された共有ファイ
ル名のホストが通信するまでトラフィックを監視し，MACアドレスが取得できる
ようになれば，情報を組み合わせる手法を採用する．そして，一度組み合わせた
情報は保存する．
%置き，ホスト名，MACアドレスのどちらかが一致したトラフィックを収集する．

トラフィックから情報を取得後，FreeBSD上で処理し，
出力結果をPHPで記述したスクリプトによって，グラフ化した．

\subsection{検証環境}
\label{evaluation:share_host:env}
取得範囲はスイッチによる情報制限を受けないため，研究室全般のネットワークから情報を収集可能である．
そこで，研究室のネットワークにおいて，2009年10月18日から21日まで本システムの実験を行った．
図\ref{fig:share_topo}に共有ホスト名を用いた実験のネットワーク概要図を示す．
\begin{figure}
    \begin{center}
      \includegraphics[scale=0.60]{./pdf/share_topo}
      \caption{共有ホスト名を用いた実験のネットワーク概要図}
      \label{fig:share_topo}
    \end{center}
\end{figure}

\subsection{検証結果}
本システムによって，共有ホスト名とホストのMACアドレスを結びつけた．検証
の結果，取得した共有ホスト名の数は28台であった．常に稼働しているホスト
は8台あり，20台のうち同じユーザと推測できるホストが7台あった．

\label{evaluation:share_host:res}
\begin{figure}
    \begin{center}
      \includegraphics[scale=0.40]{./figure/life_time.eps}
      \caption{共有ホスト名を用いたユーザ生活モデル}
      \label{fig:user_lifemodel}
    \end{center}
\end{figure}

次に，共有ホスト名をもとに，ユーザの生活時間帯を取得することができた．
図\ref{fig:user_lifemodel}にその結果を示す．このグラフは計測時間を30分
ごとに区分けして，ある時間でホストAが発見された場合，ホストAは観測され
た時間帯はネットワークにいると仮定する．プロトコルの関係上，一定時間ご
とにリストの情報をやりとりをしないため，この手法を採用した．

この結果から，大まかなユーザの生活リズムの特徴が導き出される．ユーザAは
常に研究室に在籍しており，高頻度で検出されている．次に，ユーザBは夜のみ
研究室で観測されているため，夜型の生活を送っていることが推測できる．ユー
ザBとは逆にユーザCは朝方の生活を送っており，この期間内は規則正しく研究
室を出入していることが分かる．

\subsection{考察}
共有ホストのシステムでは，ユーザとホストを結びつけることが容易になるこ
とを示した．本システムによって，MACアドレスと共有ホスト名の結びつけをす
ることで，複数ホストを利用している場合や，グループで管理しているホスト
の情報を収集できる．このシステムによってネットワーク上でファイル共有を
利用しているホストの特定が可能であるため，ユーザのプライバシを脅かす可
能性が非常に高いと言える．この情報を保持しておくと，MACアドレスとホス
トの対応が分かるため，サーバのログや，パケットのヘッダ情報と組み合わせ
ることで，より詳細なプロファイルが作成できる．ファイル共有プロトコ
ルはiTunes\cite{iTunes:2009}をはじめとする多くのアプリケーションに利用
されているため，取得が容易であると言える．

ただし，NetBIOSやmDNSといったプロトコルはサービスを利用していない場合で
も送信し続けている場合があるため，今後も仕様や設計も調査する必要がある．
しかし，ファイル共有を利用していないホストの識別が不可能である．また，
共有プロトコルは常に送信し続けるわけではない．そのため，分単位でのユー
ザの生活時間を取得できないという欠点がある．

\section{Bluetoothデバイス名}
\label{evaluation:bleutooth}
\subsection{検証手法}
筆者が所属する研究室において，Bluetoothを検出するプログラムを実行することで，
どの程度情報収集できるかを検証した．
実際に，ペアリング時にBluetoothアドレスを収集し，ユーザの実生活や機器を利
用したプロファイル作成がどの程度の情報を収集できるのかを検証した．

\subsection{設計概要}
\begin{table}
\begin{center}
\caption{Bluetoothデバイスアドレス検証手法の実装環境}
  \vspace{5mm}
\label{tb:Bluetooth}
\begin{tabular}{|c|c|c|}
\hline
仕様言語&library&OS\\
\hline 
java1.6&Bluecove 2.1.0&MacOSX 10.6.2\\
\hline
PHP&&MacOSX 10.6.2\\
\hline
\end{tabular}
\end{center}
\end{table}
Bluetoothアドレスの検証実験を行うプログラムは表\ref{tb:Bluetooth}で示すように，
java言語で記述し，MacOSX上で実行する．
使用するライブラリはbluecove 2.1.0を利用し，Bluetoothデバイスの探索を行う．
デバイス探索で検出される情報は，取得した日時，Bluetoothアドレス，Bluetoothデバイス名である．
デバイス探索の間隔は30秒に一回の割合で連続して行う．
デバイス探索後，取得した情報をファイルに出力し，出力したファイルを
PHPによるスクリプトによって，グラフによる視覚化をする．

\subsection{検証環境}
検証環境は筆者が所属する研究室だが，取得する範囲は筆者の実験ホストから
周囲数メートル範囲である．データを取得した期間は，2009年12月17日23:00か
ら2009年12月19日21:00までである．Bluetoothデバイスを探索するホストの設
置場所は研究室の中心部である．Bluetoothの有効範囲は数mから数百mと機器や
環境によって差があるため，場所やデバイスによっては検出できない場合があ
る．今回はMacBook ProとThinkPad T41の2台を用いて，事前に検証を行った．
研究室は縦22m，横7mの広さであるが，どの場所でもBluetoothデバイスが検出
されたため，手法検証を行う上で本実験機器の配置場所を問題ないとする．

\subsection{検証結果}

\begin{figure}
    \begin{center}
      \includegraphics[scale=0.50]{./pdf/Bluetooth_display}
      \caption{Bluetoothデバイスの検出}
      \label{fig:track_con}
    \end{center}
\end{figure}

\begin{table}
\begin{center}
\caption{Bluetoothデバイスアドレス検証結果}
  \vspace{5mm}
\label{tb:Bluetooth_res}
\begin{tabular}{|c|c|c|c|}
\hline
発見ホスト数&常駐ホスト数&携帯端末数\\
\hline 
26&5&3\\
\hline
\end{tabular}
\end{center}
\end{table}



上記のプログラムを実行したところ図\ref{fig:track_con}のような情報を収集した．
ここで取得できる情報はBluetoothデバイスアドレスと取得時間，設定しているBluetoothデバイス名である．
共有名と同じく，MacOSXを利用しており，かつデフォルトで設定をしていない場合は
所有者とホストの機器名が表示される結果になった．

次に，取得したデータを解析した結果を表\ref{tb:Bluetooth_res}に示す．
検証期間内に取得したBluetoothアドレスは全部で26あった．
第\ref{background:user_in_network}節では，この研究室に100台近くの
ホストがあることを示しているため，Bluetoothを利用しているホストは比較的
少ないといえる．その中で，24時間常に稼働しているホスト5台発見された．こ
れらはサーバとして利用されている可能性が高い．次に，ホストではないスマー
トフォンと思われる機器が3つ観測されている．また，共有ホスト名に表示され
る情報をもとに，ホスト間の関係が推測ができる．今回観測された情報か
ら，Bluetoothデバイス名が同じ機器が3組あった．そのうちひとりで3台のホストを利用
しているユーザや，グループで管理されているホスト郡が観測された．このよ
うに，Bluetoothデバイス名を利用するだけでユーザやグループがどのくらいのホストを
利用しているのか推測できる．

また，Bluetoothアドレスは固有のものであり，ホスト名とバインドすることによって，
共有ホスト名と同じように，生活時間や場所のトラッキングが可能となる．
図\ref{fig:Bluetooth_track_life}に取得した情報によって作成したグラフを
示す．このグラフの作成も，図\ref{fig:user_lifemodel}と同じく手法で作成し
た．Bluetoothデバイス検索は常時行われるため，連続して収集するこ
とができるため，5分毎に区分けし，観測された時間帯は収集機器の周辺にユーザがいるものとする．

この検証では，一般的に持ち歩きしているユーザのホストを3種類選び出した．
3人のユーザも特徴が出ている．ユーザA，Bは比較的夜型の傾向があることに対して，
ユーザCは昼に研究室に訪れている．
また，この検証は木曜日から土曜日にかけて行っているため，どのユーザ
も土曜日の夕方まで研究室を訪れてないことが分かる．

\begin{figure}
    \begin{center}
      \includegraphics[scale=0.35]{./pdf/Bluetooth_lifetime}
      \caption{Bluetoothデバイスの検出によるユーザのライフタイム}
      \label{fig:Bluetooth_track_life}
    \end{center}
\end{figure}

\subsection{考察}
Bluetoothのシステムを利用した結果，Bluetoothデバイス名とBluetoothアドレスを取得
することができた．このシステムを応用することによって，ユーザの場所や生
活時間を取得することができる．ユーザの場所は，本システムを様々な場所に
設置することによって検出可能である．本システムでは30秒に1度デバイス探索
をするため，共有ホスト名のシステムよりも容易かつ正確に取得できる．ター
ゲットが学生であり，設置場所が研究室だと想定すると，ユーザが検出されな
かった時間の講義やイベントを探すことで，ユーザがどこにいるのかを推測す
ることもできる．このことから，Bluetoothはユーザプライバシを脅かす可
能性があるといえる．Bluetoothデバイス名は設定していない場合はユーザ名とOS名とな
る．そのため，共有ホスト名のシステムと連動することで，MACアドレス，ホス
ト名，Bluetoothアドレスの3つを結びつけることができる．そして，結びつけ
たMACアドレスから共有ホストと同じように多くの識別要素と結びつけることで，
ユーザのプロファイルが可能となる．検証の章でも述べたように，Bluetoothを
利用するユーザが多いとは言えないが，今後のBluetoothの普及次第によっては
非常に強力な識別要素となる．しかし，Bluetoothのデバイス探索は，ユーザが
探索をしたい場合にのみ利用するのが一般的であるが，実験結果や高木浩光の
調査で挙げているように常時探索をしているデバイスが数多くあることが分
かる．常時探索が有効な機能であるかは議論が必要である．

\section{検証した情報の統合}
Bluetoothデバイス名，共有ホスト名，パケットのヘッダ情報を統合することに
よって，より正確な個人を特定することができる．
検証に得られた情報を表\ref{tb:combine_info}に示す．

\begin{table}
\begin{center}
\caption{検証で利用した情報}
  \vspace{5mm}
\label{tb:combine_info}
{\footnotesize
\begin{tabular}{|c|c|c|c|}
\hline
利用情報&パケットヘッダ情報&共有ホスト名&Bluetoothデバイス名\\
\hline
\hline
一意にホストを&なし&MACアドレス&Bluetooth\\
識別できる情報&&&デバイスアドレス\\
\hline
ホストの推測に&パケットのヘッダ情報&共有ホスト名&Bluetoothデバイス名\\
利用できる情報&ホスト情報&位置情報&位置情報\\
&利用サービス&接続時間&生活リズム\\
\hline
\end{tabular}
}
\end{center}
\end{table}

検証の結果，個々の情報収集手法からホストの情報だけでなく，ホストや所有者
の情報を取得できることが分かった．そこで，パケットのヘッダ情報，共有ホ
スト名，Bluetoothの情報を組み合わせるシステムをISPやネットワーク管理者
が利用した場合，ユーザが特定される可能性を考察する．本手法では，パケッ
トのヘッダ情報とその傾向を利用してプロファイルを作成する．そのた
め，ISPのような大規模ネットワークにおいて，パケットのヘッダ情報といった
識別要素のみではユーザのプロファイルが困難である．識別要素には，共有ホスト
名や，Bluetoothのデバイスアドレスも識別要素として利用可能である．パケット
のヘッダ情報だけでは，ユーザの振る舞いによって，ホスト識別の精度が変化
する．しかし，共有ホスト名とMACアドレス，Bluetoothのデバイスアドレスを
組み合わせた情報を保持することで，条件が整えばユーザがホストを複数持っ
ていた場合や，ホストを変えても追跡が可能である．最終的には，ホストと携
帯電話などの機器の組み合わせ，ネットワークに繋がるすべての機器
と，Bluetoothを利用できる機器を結びつけてプロファイルすることができる．
そして，各機器から，実ユーザの位置，時間，行動傾向といった個人に関わる
情報が本人の知らない間に利用される危険性がある．


%\subsection{ユーザが特定される場合}
%実際にどのような情報を組み合わせるとユーザの特定につながるのかを考察する．
%ユーザを特定する場合はパケットのヘッダ情報と共有ホスト名によって特定できる．
%ホスト情報と共有ホスト名によっては情報が容易に取得できる．
%表\ref{tb:combine_info}に記した，内容を組み合わせることで多くのことが分かる．
%特に，MACアドレスが取得できた場合が顕著である．
%
%\subsection{ユーザが特定される可能性がある場合}
%\subsection{ユーザが特定されない}
%


以上のことからパケットのヘッダ情報，共有ホスト名，Bluetoothデバイスは，ユーザをトラッ
キングするにあたり，非常に有効な手段であるとともに，ユーザのプライバシ
に脅威を与えるものであると言える．



\section{まとめ}
本章では3つの仮説を検証した．パケットのヘッダ情報と，共有ホスト
名，Bluetoothによるホスト識別の可能性である．パケットのヘッダ情報のみを
用いて，ホストを識別する手法は，ネットワークの中継地点に設置し，定常的
にヘッダ情報のみを収集し，識別要素をもとにホストを分類する．これによって，
ネットワーク上のホスト7台のうち4台を識別することができた．次に，共有ホ
スト名，Bluetoothアドレスはホストとユーザ名をデフォルトで設定しているとユーザ
が利用しているホストやユーザ自身の生活の推測が可能になることを示した．
これら3つの情報は，ユーザのプライバシを脅かす可能性が十分にあると言え
る．
%%% Local Variables:
%%% mode: japanese-latex
%%% TeX-master: "../nakajima_bthesis"
%%% End:

