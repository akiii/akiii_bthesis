\chapter{デジタル情報を用いたユーザ特定手法}
\label{assumption}
サービス・コンテンツ提供者は，ユーザに応じた効率的なサービスを提供する
ことが求められる．様々なユーザのプライバシを考慮しながらも，ユーザの情
報を収集する必要があるので，ユーザの同意を得るなど制限を付けて，取得す
る情報としない情報を明確にする必要がある．

第\ref{background}章で述べたように，情報収集者が取得する情報は，対象ユー
ザとのネットワーク上の関係によって変化する．そのため，情報収集者と対象
ユーザのネットワーク上の位置関係ごとにユーザのプライバシに影響を与える
手法を提案した．図\ref{fig:zentai}に観測者と利用情報ごとに分けた手法を
示す．まず，ネットワーク管理者はパケットのヘッダ情報を利用したホストの
特定をする．次に，同一セグメントのユーザは，サービス探索情報を利用し
たプロファイルを作成する．最後に，同一ネットワークに接続していないユー
ザは，Bluetoothを利用したプロファイルを作成する．これら3つの手法につい
て述べる．
\begin{figure}
    \begin{center}
      \includegraphics[scale=0.55]{./pdf/zentai}
      \caption{ユーザ特定手法の全体図}
      \label{fig:zentai}
    \end{center}
\end{figure}


\section{ネットワーク管理者と取得情報}
\label{assumption:admin}
ネットワーク管理者にとって収集が容易であるものの一つに，トラフィックデー
タが挙げられる．しかし，ユーザを一意に識別できる，パケットのペイロード
やMACアドレスなどはネットワークのポリシや構成によって取得できない場合が
ある．そこで，パケットのヘッダ情報に焦点を当て，パケットのヘッダ情報の
みから，ホストを特定する手法を提案する．

\subsection{前提}
\label{assumption:admin:premise}
%3) その情報をどのように利用するとどのような結果が得られるのか
パケットヘッダ情報取得によるプライバシの脅威に関する手法の前提について
述べる．パケットの情報を取得するネットワーク管理者は，ネットワークのポ
リシを自由に設定できるISPやネットワーク管理者を想定する．
図\ref{fig:packet_model}に示すように，管理者がパケットのヘッダ情報を収
集する機器を，ネットワークの中継地点で設置することによって，ネットワー
クトラフィックを取得する．ネットワーク構成は一箇所のみ外に出る回線が存
在し，同じネットワークにおいてユーザの発信するパケットは必ずその機器を
通過するものとする．

\begin{figure}
    \begin{center}
      \includegraphics[scale=0.55]{./pdf/packet_model}
      \caption{パケットヘッダ情報の収集システムの概要}
      \label{fig:packet_model}
    \end{center}
\end{figure}


\subsection{パケットのヘッダ情報}
\label{assumption:pakcet}
% 1) なぜその情報に注目したか
パケットのヘッダ情報はネットワーク上を流れるトラフィックを観測するだけ
で取得することができるが，ペイロードを含む情報を得る場合，ユーザの個人
情報と密接な関わりがあるためユーザの同意が必要である．しかし，ネットワー
ク管理者が，ネットワーク帯域の制御，ネットワーク上の通信の統計やトレン
ドを利用したい場合，パケットを閲覧するために全てのユーザの同意を得るこ
とは困難である．そのため，ペイロードは閲覧せずにヘッダ情報のみでネット
ワーク全体のトラフィックを収集する手法が提案されている\cite{blinc:2005}．
ここで述べているパケットのヘッダ情報は送信先，発信元IPアドレス，ポート
番号，プロトコルを指す．しかし，パケットのヘッダ情報を収集する手法が，
ユーザのプライバシを脅かさないとは断言できない．
%2)なぜその仮説を提案するに至ったか

各ユーザはそれぞれの利用状況に応じた特徴的なパケットを送受信している．
ヘッダ情報からは，送信先・発信元IPアドレス，ポート番号から使用している
サービス，アプリケーションの使用頻度の情報が取得できる．そして，送信
先IPアドレスからはユーザの通信相手の情報が把握可能である．これによって，
該当ユーザはどのようなホストと通信する傾向があるかを把握できる．他にも
ヘッダ情報のみでOSを推測するPassive Finger
printing\cite{passivefinger:2010}を利用することで，ホストの識別要素とな
る．このように，多くの技術を組み合わせることによって，ホストに関する情
報を蓄積できる．この蓄積した情報をもとにホストの特定をする手法を提案する．
接続頻度が多いホストや，起動時の挙動，プロトコルと転送量を収集すること
で，ホストがアクセスする傾向のあるサイトや，利用しているアプリケーショ
ン，ネットワーク上での挙動を推測できる．

% 4) それがどのようなインパクトを誰に与えるのかこの手法によってユーザの
% プロファイルが作成できれば，ネットワーク管理者もネットワークに流れる
% トラフィック情報の取扱い方，ユーザの同意といったプライバシに配慮した
% ポリシを考慮しなければならない．また，一般ユーザは，個人に関わる情報
% を知らずに常時発信しており，ネットワーク管理者などによってユーザのプ
% ライバシが脅かされている可能性がある．

\subsection{ホスト識別による調査}
\label{assumption:used}

実際にパケットのヘッダに含まれる情報が識別要素として成り立つのかという事
前調査調査を行った．以下に個人の特定に利用できる情報を述べる．

\subsubsection{個人の特定に利用できる情報}

\begin{itemize}
\item{\bf 送信先IPアドレスとポート番号の組み合わせ}\\
　送信ポート番号とIPアドレスの関係に着目して調査を行った．
その結果，識別要素として想定していたIPポート番号による識別は困難であること
が判明した．図\ref{fig:userA_ipport}にホストAの送信先IPアドレス・ポート
番号，図\ref{fig:userB_ipport}にユーザBの送信先IPアドレス・ポートを記
す．X軸がIPアドレス，Y軸がポート番号を示す．

\begin{figure}
    \begin{center}
      \includegraphics[scale=1.06]{./pdf/userA_ipport}
     \caption{ホストAの送信先IPアドレス・ポート番号}
     \label{fig:userA_ipport}
    \end{center}
\end{figure}

\begin{figure}
    \begin{center}
      \includegraphics[scale=1.06]{./pdf/userB_ipport}
     \caption{ユーザBの送信先IPアドレス・ポート番号}
     \label{fig:userB_ipport}
    \end{center}
\end{figure}

　二つの図からホストA，Bの明確な差異を見つけることができなかった．しか
し，SSHやIMAPの利用先など，プロトコルと接続先IPアドレスによっては，ホス
トごとに特徴を得ることができた．このことから，送信先IPアドレス，ポート
番号の組み合わせはポート番号によってはユーザの識別要素としては利用できる
という結論に至った．ホスト識別に利用できるプロトコルは，IMAP，SSH，VPNな
どが挙げられる．

\item{\bf 発信元ポート番号}\\
  　OSごとに発信元ポート番号は異なり，特徴がある可能性がある．そのため，
  発信元ポート番号の利用を比較する．その結果を図\ref{fig:port_src}に示
  す．図\ref{fig:port_src}のMacOSXとWindows XPの発信元ポート番号を比較
  した場合，容易に差を発見することができる．Windows XPとMacOSXをさらに
  長期的に観測したが，同じソースポート番号を利用されることはなかった．
  これは ，OSごとに送信元の利用ポートの傾向が違うためである．つまり，送
  信元ポート番号を収集することはOSを推測できる．他OSを計測した場合，発
  信元ポート番号を利用した検証結果は表\ref{tb:src_portos}にまとめる．　
  以上のことから，IPアドレスと送信元ポート番号は識別要素として利用する
  ことはできないが，送信元ポート番号を得ることでOSを分類することができ
  る．

\begin{figure}
    \begin{center}
      \includegraphics[scale=0.70]{./pdf/src_port}
     \caption{MacOSXとWindowsXPの利用送信元ポート番号}
     \label{fig:port_src}
    \end{center}
\end{figure}

\begin{table}
\caption{OSと利用発信元ポート}
\label{tb:src_portos}
\begin{center}
\begin{tabular}{|c||c|}
\hline
OS&発信元ポート\\
\hline 
FreeBSD&49152-65535\\
Ubuntu&32768-61000\\
Windows XP&1024-5000\\
Windows Vista&49152-65535\\
MacOSX&49152-65535\\
\hline
\end{tabular}
\end{center}
\end{table}

\item{\bf パケットの発信タイミング}\\
  　ホストの識別にあたり，最初の起動時間から数分の間パケットのヘッダ情
  報を観測することでホストを個別に特定することができるという仮説を立て
  た．実際に，ホストはOSやスタートアップに登録してあるアプリケーション
  が起動時に立ち上がるため，ユーザのパケットの発信タイミングからホスト
  を識別できる可能性がある．ホストによっては，利用しているアプリケーショ
  ンやサービスなど様々な特徴があるため，各ホストが発信するパケットのタ
  イミングを識別要素として利用できる仮定した．そこで，OSが起動してから
  ユーザが操作をするまでのタイミングに焦点を当て，個人差が出るかの調査
  をした．タイミングを収集するとして，ホストにIPアドレスが付与されてか
  ら約2分間の情報を調査する．しかし，パケットの取得タイミングはネットワー
  クによって依存するため，同じネットワーク上で取得するという条件のもと
  パケットのトラフィック取得を行った．タイミング取得において，どの要素
  が毎回確認される共通のデータであるのかを取得した．実際に7回OSを繰り返
  して再起動
  を行い，IPアドレスが付与される最初の2分間のタイミングを取得した．\\
  　今回はMacOSX version 1.6とWindows VistaのOSを対象とし，クリーンイン
  ストールした状態で検証を行った．まず，MacOSXの結果を
  図\ref{fig:start_up_mac}に示す．X軸がIPアドレスが付与されてからの経過
  時間であり，Y軸が再起動回数である．グラフの点は，ホストがパケットを発
  信した際に描かれる．次に，Windows Vistaの場合
  のタイミングを図\ref{fig:start_up_win}に示す．

\begin{figure}
    \begin{center}
      \includegraphics[scale=0.65]{./pdf/stup_mac2}
      \caption{MacOSXの起動時のパケットの発信タイミング}
     \label{fig:start_up_mac}
    \end{center}
\end{figure}

\begin{figure}
    \begin{center}
      \includegraphics[scale=0.65]{./pdf/stup_win2}
      \caption{Windows Vistaの起動時のパケットの発信タイミング}
      \label{fig:start_up_win}
    \end{center}
\end{figure}

　MacOSXに関しては，最初の数分間において一定の通信を繰り返す傾向が強く，
比較的に特徴の出やすい結果であることが分かる．特に，起動してから1秒後か
ら2秒後が特徴的であり，このタイミングを取得することで識別要素として利用
できる可能性があると推測できる．それに対してWindowsの場合はIPアドレスが
付与されてから数十秒は連続的な通信が多いため，WindowsとMacOSX と大きな
違いが出たと言える．特に顕著なのがMAC OSと同じく1秒から2秒の挙動である．
この挙動の間隔の差
を利用することによって，OSの特定が可能であると言える．\\
　次に，各パケットのプロトコルとポート番号を示す．二つのOSのパケット送
信タイミングを種類に分けて更に詳しく解析したグラフが
図\ref{fig:port_mac}と図\ref{fig:port_win}である．プロトコルごとに分類
し，ポート番号別に表示した．図\ref{fig:port_mac}，図\ref{fig:port_win}はX軸がIPアドレスが
付与されてからの時間に対して，Y軸はポート番号を指している．また，色によっ
てUDP，TCP，ICMPの3種類によって分類している．これによっ
て，mDNSやSMB，DNSなどの通信が多く観測できる．ここからパケットの共通項
を取得する．他にも，毎回挙動が違うパケットを排除する．例え
ば，LDAPやNetBIOSなど，
ネットワークを構成するホスト群に作用されるパケットを排除する．

\begin{figure}
    \begin{center}
      \includegraphics[scale=1.00]{./pdf/mac_port}
      \caption{MacOSXのポート番号とプロトコル別パケットの発信タイミング}
      \label{fig:port_mac}
    \end{center}
\end{figure}

\begin{figure}
    \begin{center}
      \includegraphics[scale=1.00]{./pdf/win_port}
      \caption{Windows Vistaのポート番号とプロトコル別パケットの発信タイミング}
      \label{fig:port_win}
    \end{center}
\end{figure}

　今回の前提として，ネットワーク管理者を想定しているた
め，MSNDやNetBIOSなどのマルチキャストやブロードキャストの通信を取得でき
ない可能性がある．そこで，マルチキャストやブロードキャストを除いた場合
は，これらの情報を取得することが困難である．特に，MacOSXで容易に発見で
きた図\ref{fig:start_up_mac}でのホストの特徴はマルチキャストで
あるため，タイミングのみでホストを識別することのは困難である．MacOSXと同じくmDNSやSMBのパケットが多く送信されているが，Microsoft社のサーバに対してHTTP通信をしているため，TCPのパケットを発信するタイミングに着目することで容易に発見できる．\\
　そこで，パケットの発信のタイミングを起動してからの数十秒後に焦点を当
てる．実際にアプリケーションが起動する時間を計測したところ，IPアドレス
が付与されてから約60秒後に事前に登録してあるアプリケーションが起動して
いたため，60秒後の挙動に着目した．60秒から120秒の間にパケットの発信があっ
た場合，なんらかのアプリケーションが自動起動に設定されている可能性があ
る．図\ref{fig:port_mac}にある図のTCPはNetBIOSセッションサービスであり，
識別子としては除外される．このパケットの送信タイミングとプロトコルを利
用して，自動起動に設定されていないホストと設定して
いるホストに分類できる．\\
　次に，自動起動に設定しているアプリケーションを特定する必要があるが，
非常に多くのアプリケーションがあるためすべてを網羅することは不可能で
ある．そこで，今回は利用者が比較的多いIMAPとMSNメッセンジャを対象として取り上げる．\\
　IMAPやMSNメッセンジャは利用するポートが固定されており，imapは993番で
ありMSNは1864番である．このポート番号から取得するパケットのトラフィック
量から個人の識別要素として利用できる可能性が挙げられる．例えば，MSNメッ
センジャなどは連絡先のユーザのリストを保持しているため，そのリストをダ
ウンロードしなければならない．それを利用することによって，どの程度リス
トを登録しているのかを推測できる．同様に，IMAPを利用するためにはサーバ
からフォルダやメールのリストをダウンロードする必要がある．
このトラフィック量からユーザの識別要素として利用することができる．\\
　上記の方法はホスト起動時の数分間の挙動をもとに推測を行っているため，
ネットワークに参加するユーザが電源を落とした状態から起動したか，サス
ペンドもしくはハイパネーションから復帰したかによって，取得するべき情報
や除外すべき情報は大きく変化する．その起動か休止状態からの復帰かを判断
する方法にパケットの発信タイミングを識別要素として利用することができる．
これらの手法を用いて，IPアドレスが付与された時間からパケット発信のタイ
ミングを計測することで，ネットワークに接続したホストが，起動したのか，
復旧したのかを容易に判別することができる．図\ref{fig:up_or_sus}はIPアド
レスが付与されてからのホストの起動時と復旧時のパケットの送信タイミング
の比較である．X軸がIPアドレスが付与されてからの時間に対して，Y軸は起動
時の挙動，復旧時の挙動といったラベルである．

\begin{figure}
    \begin{center}
      \includegraphics[scale=0.70]{./pdf/startup_suspend}
      \caption{起動時と復旧時におけるパケットの発信タイミングの比較}
      \label{fig:up_or_sus}
    \end{center}
\end{figure}


　同じクリーンインストールを利用したMacOSXであるのに対して，明確な差が
生まれた．復旧時は電源が落ちている状態からの起動時に比べて，早くホスト
を利用することができる．サスペンドもしくはハイパネーションはアプリケー
ションやOSに必要な機能を立ち上げている状態で行われるためある．また，最
初の数十秒の挙動は同じOSであればどのホストでも同じであるため，起動して
数秒で異なる挙動をした場合，
休止状態から復旧したと判断することができる．\\
　OSが休止状態から復旧した場合は，個人特定の重要な識別要素となる．OSが
利用する発信元ポート番号は異なることは前述した通りである．休止状態から
復旧した場合，発信元ポートは連続したポート番号を利用する．つまり，休止
前に利用されていた発信元ポートの数個先のポート番号を利用する傾向がある．
そこでホストの利用している最後の発信元ポート番号を保存することによって，
そのホストが同じネットワーク上で復旧した場合，ホストの識別要素となり得
る．しかし，一度ホストを再起動すると発信元ポートは初期値に戻るため，送
信元ポート番号を利用した識別手法は復旧したホストにのみに利用することが
できる．

\item{\bf ホストが利用するサービス}\\
  　ユーザが利用する送信先アドレスや，ポート番号から分かるサービスを識
  別要素とする．例えば，Webサービスを使用する場合，利用しているWebサイ
  トによってユーザをプロファイリングできる．サービスの利用頻度や傾向は
  ユーザごとに差異あるため，ユーザの識別要素としても有効である．このた
  め，WebアプリケーションやSNSを利用する頻度や時間帯を各ユーザごとに調
  べることによって類似するユーザを調査する．例え
  ば，mixi\cite{mixi:2009}やTwitter\cite{twitter:2009}などにアクセスす
  る時間帯や間隔を各ユーザごとに記録する．これらはユーザ特有の傾向である
  ためユーザ識別の識別要素となり得る．また，ユーザの所属するネットワー
  クのMailサーバ，Webサーバへのアクセス情報も重要である．そこで本研究
  は各ユーザのアプリケーションやサービスの利用頻度やアクセスする間隔を
  用いてユーザを識別する．

\item{\bf 利用アプリケーション}\\
\begin{table}
\caption{識別要素とする対象ツール一覧}
\label{tb:tools_list}
\begin{center}
\begin{tabular}{|c||c|}
\hline
対象ツール&主な機能\\
\hline 
Thunderbird&メールクライアント \\
Outlook&メールクライアント \\
firefox& Webブラウザ \\
safari& Webブラウザ \\
Omunigraffile&描画ツール\\
Skim&pdf編集ツール\\
Windows update&OS アップデート \\
MacOSX software update&OS アップデート \\
GOM player&メディアプレイヤ \\
Quick Time&メディアプレイヤ \\
VLC media player&メディアプレイヤ \\
Windows media player&メディアプレイヤ \\
\hline
\end{tabular}
\end{center}
\end{table}
　ホストの利用するアプリケーションによってユーザのプロファイル作成は可
能である．表\ref{tb:tools_list}にホスト識別要素とする対象アプリケーショ
ンを示す．次に，Webアクセスなど履歴からユーザの興味動向を推測す
る．HTTPプロトコルとIPアドレスの接続頻度を利用できる．また，OS起動時に
自動的にアプリケーションが同時に起動する場合がある．その際に，アクセス
する先を記録することでホストを分類する識別要素となる．これらの識別要素
を利用して，ホストの分類，最終的にはプロファイルを作成する．

\item{\bf パケットのオーダ}\\
  　パケットが発信される順序を取得し，IPヘッダやTCPヘッダを組み合わせて
  解析することによって，ユーザのOS情報を知ることができる．Passive OS
  Fingerprintingを利用することによってユーザの所有しているホストを把握
  する．

以上がパケットのヘッダ情報を利用してホスト識別する手法に採用した情報で
ある．
\subsubsection{個人の特定に利用が困難な情報}
\item{\bf DHCPから割り当てられるIPアドレス}\\
  　ネットワークにおける通信ではIPアドレスはホストの識別要素として利用
  されている．IPアドレス単体に焦点を当てた場合，ホストやユーザとしての
  識別要素として成り立つのかが問題がある．そこで，DHCPサーバのログ
  を2009年7月12日6時から7月18日6時まで取得し，分析した．
  図\ref{fig:dhcp}は筆者が所属する研究室のネットワークにおけるホスト
  のIPアドレス遷移を示す．取得したIPアドレス数は233に対して取得し
  たMACアドレス数は321であった．そのうち，同一と見られるホストのIPアド
  レス遷移は101回あり，期間中に7回もIPアドレスがつけ変わるホストが存在
  した．つまり，観測した6日間に，43\%のホストのIPアドレスが変化する結果
  になった．DHCPサーバの設定上，過去にIPアドレスを付与したホストには同
  じアドレスを割り振られる．また，同じホストが継続してネットワーク参加
  する場合も同じIPアドレスが割り振られる．図\ref{fig:dhcp}でも挙げられ
  るように，一度もIPアドレスが変化しなかったホストは130台あった．しかし，
  付与するIPアドレスの範囲以上にホストが存在した場合，IPアドレスはつけ
  変わってしまう．そのため，ネットワークにおいてホストやユーザの識別
  に，IPアドレス単体では識別要素として利用できない．

\begin{figure}
    \begin{center}
      \includegraphics[scale=1.00]{./pdf/dhcp}
      \caption{時間におけるホストのIPアドレス遷移回数}
      \label{fig:dhcp}
    \end{center}
\end{figure}




\item{\bf 起動時間・接続頻度}\\
　ユーザがホストをネットワークに接続した時間や接続時間帯の規則性を記録して，
本人の生活習慣をユーザの識別要素とする．
人間の生活習慣は多少のぶれが生じるが，傾向を把握することによって，パターンを取得できる可能性がある．
そのため，ユーザがネットワークに接続する頻度やその接続時間はユーザの識別の材料となる．
これに加え，本システムはホストを起動時に一番最初に利用するプロトコルや通信傾向も識別要素とする．
長期的にネットワークトラフィックを取得した場合ユーザごとの傾向が分かれ
るが，短期間しかトラフィックが取得できない場合はユーザごとに差異を見つ
けるのは困難である．
\item{\bf 接続位置}\\
　ネットワーク上の様々な位置に本システムを設置することによって，
ホストの接続位置を取得する．
これによって，ユーザの行動範囲を把握することが可能となる．
しかし，この情報を利用できるかはネットワーク構成に依存するため，今回は
取得しないものとする．

\item{\bf TCP SYN パケットの送信先IPアドレス}

\begin{table}
\begin{center}
\caption{送信先IPアドレス上位リストの類似調査}
  \vspace{5mm}
\label{tb:dst_IP}
\begin{tabular}{|c|c|c|c|}
\hline
 &ホストA&ホストB&ホストC\\
\hline 
1回&1& 0 & 0\\
\hline 
2回&0& 1 & 0\\
\hline
\end{tabular}
\end{center}
\end{table}

　ホストの送信先IPアドレスの頻度はホストを識別することができるのか調査
を行った．今回は，接続頻度の高い送信先IPアドレス上位5位を取得した．また，
同じネットワークの内での通信は除外する．調査したネットワークは筆者が所
属する研究室でのネットワークであり，取得期間は，2009年6月25日19時45分か
ら22時20分までである．その結果を表\ref{tb:dst_IP}に示す．\\
　各期間における調査対象のユーザの上位5位のリストうち，ホストAと同
じIPアドレス1つ，ホストBに関しては2つ見られたが，ホストCは同じIPアドレ
スが見られなかった．これらの情報は，ネットワーク構成や，ユーザの利用頻
度によって，この容易に変動してしまうため，上位のリストのみでホスト識別
要素として利用することは困難である．

\end{itemize}


\section{同一セグメント上のユーザと取得情報}
\label{assumption:same_networkl}
ユーザは同一セグメントに接続すると，ブロードキャストやマルチキャストと
いったネットワーク全体に送信する情報を受け取ることができる．その中でも，
ファイル共有をする際に利用する情報はホスト利用者を特定できる可能性があ
る．他にも，ホストの固有識別要素であるMACアドレスも取得できる．そこ
で，WindowsやMacOSXで利用されているmDNSやNetBIOSとMACアドレスなどホスト
情報を利用することで，ネットワークにおけるユーザのプライバシを脅かす手法
を提示した．第\ref{assumption:admin}節のパケットのヘッダ情報によるホス
トの識別と異なる点は，既にホストの識別された情報を利用するため，ホスト
利用者のプライバシが脅かされる点である．

\subsection{前提}
前提として，スイッチなどで対象とするユーザのNetBIOS，mDNSといったプロト
コルの取得を妨げることはないネットワーク構成を想定する．情報を取得する
ユーザは，一般ユーザであり，ネットワークにおけるサーバ，ルータ・スイッ
チ類へのアクセス権限はないものとする．また，無線LANであればプロミスキャ
ス　モードを利用して，同じチャンネルに接続している情報を収集できるが，
今回はその場合を想定せず，有線ネットワークを利用した環境を想定する．
図\ref{fig:share_model}にその概要図を示す．

\begin{figure}
    \begin{center}
      \includegraphics[scale=0.40]{./pdf/share_model}
      \caption{パケットヘッダ情報の収集}
      \label{fig:share_model}
    \end{center}
\end{figure}

\subsection{共有ホスト名}
%1) なぜその情報に注目したか
ネットワークに接続すると，OSによってはDHCPサーバやプリンタをはじめとする機器
を探索する．探索はブロードキャストやマルチキャストといったネットワーク
全体または複数のホストに送信される．その中でも，ファイル共有のプロトコ
ルは共有ホスト名やOS情報といったプライバシに関する情報が含まれている．
これらの情報はネットワークのトラフィックに頻繁に見られる傾向にある．
そのため，これらの情報を収集することで，ホストやユーザのプロファイルが作成できる可能性が高い．

%2) なぜその仮説を提案するに至ったか
mDSNやNetBIOSは設定した共有ホスト名や機器名をマルチキャストで送信している．
そして，それらの情報は簡単に閲覧可能である．
例えば，
図\ref{fig:share_mac}では，MacOSXのFinderアプリケーションのキャプチャー
を表示している．ここで表示しているのはネットワークにおける共有時のホス
ト名を表示している．これによって，このネットワークにおいて，どのホスト
が共有可能かが判別できる．また，MacOSXの場合，デフォルトで共有が設定され
ている場合がある．その場合，ユーザ名とホストで表示される．
図\ref{fig:share_mac}にある，{\bf ISCのホスト}等が挙げられているが，この場合
ユーザがISCという名前で設定されている．しかし，ホストが個人所有のもので
ある場合，{\bf 上原雄貴のMac Book Pro}と表示されてしまい，ホストの所有
者がネットワーク上で公開されている．
\begin{figure}
    \begin{center}
      \includegraphics[scale=0.50]{./pdf/share_mac}
      \vspace{-5mm}
      \caption{MacOSXのFinder}
      \label{fig:share_mac}
    \end{center}
    \vspace{-5mm}
\end{figure}

%3) その情報をどのように利用するとどのような結果が得られるのか
図\label{fig:sharet_model}にも示すように，
同一セグメントに接続するだけで，共有を許可しているホストの機器名や名
前を取得することができる．共有ホスト名だけでなく，機器固有のMACアドレス
も同時に取得できるため，それらを組み合わせてホストやユーザの特定が可能
である．特にMACアドレスといった一意情報と共有ホスト名を組み合わせると，
ホストと人のマッピングすることができる．そして，この情報を蓄積し，利用
することによって，ユーザの場所や生活時間など実生活上のプロファイル情報
や場所情報，利用しているホストのOSといったプロファイルを作成することが
できる．また，一人で複数のホストを利用しているユーザであったり，グルー
プで共有して保持しているホスト群を推測することができる．


%4) それがどのようなインパクトを誰に与えるのか
これによって，ホストの利用者の実生活の情報やユーザが所持しているホスト数が分か
る．そして，共有ホスト名とMACアドレスを組み合わせることによって，ネッ
トワーク上でユーザの追跡ができるようになる．

%5) これは第2章で説明していた形式のどれにあたるのか



\section{第三者であるユーザと取得情報}
%1) なぜその情報に注目したか
同じネットワークに存在しないユーザの取得できる情報は限定される．同じネッ
トワークに存在しないユーザはトラッキング対象のユーザが利用するようなサー
ビスを提供するか，ユーザが周囲にむけて発信する情報を取得のみできる．

ユーザが周囲に発信する情報に焦点を当てると，無線LANやBluetoothの通信が
挙げられる．その中で，第三者でも容易に取得可能なBluetoothの通信に着目し
た．Bluetoothはペアリング時にBluetooth名を周囲に発信するが，その情報が
ユーザ特定の識別要素になる可能性が高い．

\subsection{前提}
\label{assumption:pakcet}
Bluetoothの情報を収集するにあたり，収集する機器はBluetoothしかネットワー
クに接続することはできず，それ以外の情報を収集することはできないとする．
また，収集する場所のばらつきを防ぐため，収集する機器は固定し，常にBluetoothデバ
イスを探索し続ける．


\subsection{Bluetooth}
%2) なぜその仮説を提案するに至ったか
近年多くの機器にBluetoothが導入されている．Bluetoothは簡単にユーザも発
信することができ，周囲もそれを知ることができるため，Bluetoothデバイスア
ドレスが個人のプライバシに影響する場合は問題である．Bluetoothは機器によっ
てはデフォルトで設定されており，ユーザは知らずに利用している可能性
がある．また，ユーザが理解して利用している場合でも，プライバシが脅
かされる可能性がある．そこで，Bluetoothによってホストだけでなく携帯電話
などBluetoothを利用する機器のプロファイルを作成する手法を提示する．

第\ref{background:user_in_network}節で，Bluetoothのペアリングについて述
べたように，ペアリングにおいて，機器の通信範囲全体にBluetoothデバイスア
ドレスを送信する．そのため，ネットワーク上で機器固有の識別要素として扱
われる可能性がある．実際に，携帯にデフォルトで設定されている場合があり，
常にBluetoothデバイスアドレスを発信し続けているケースが有る．そのよう
なBluetoothデバイスアドレスを取得して保持しておくことでユーザのトラッキ
ングする手法を提示する．実際に，駅など人が集まるところで，Bluetoothデバ
イスを探索し，トラッキングをおこなったという試みもされてい
る\cite{takagi:2009}．

%3) その情報をどのように利用するとどのような結果が得られるのか
Bluetoothアドレスによって，機器を保持したユーザを推測できる．また，ホストの
ファイル共有とは違い，携帯電話など小型な機器までもBluetoothに対応してい
るため，RFIDタグのような利用も考えられる．これによって，実ユーザが移動した
場所や滞在時間なども組み合わせてプロファイルを作成することができる．
図\ref{fig:Bluetooth_model}に示すように，各場所に本システムを設置することで，
その人の訪問した時間，滞在時間，退出時間などを知ることができる．このシ
ステムを要所に設置することで，実空間におけるのトラッキングが可能である．
\begin{figure}
    \begin{center}
      \includegraphics[scale=0.45]{./pdf/Bluetooth_model}
      \caption{Bluetooth情報の収集}
      \label{fig:Bluetooth_model}
    \end{center}
\end{figure}
%4) それがどのようなインパクトを誰に与えるのか
これによって，Bluetoothを利用しているすべてのユーザが影響を受ける．
特に，実空間や移動した場所が記録として保持される．また，Bluetoothデバイスアドレスは
固有で変更ができないため，一度プロファイリングされてしまうと，
機器を変える以外に追跡を防ぐ手段がない．

以上のことからこの手法の検証は必要である．
Bluetoothデバイスアドレスを収集し，ユーザの実生活や機器のIDを利用したプ
ロファイル作成がどの程度の情報を収集できるのかを検証する．

\section{検証情報統合によるリスク}
検証に利用するパケットヘッダ情報，共有ホスト名，Bluetoothデバイス名を組
み合わせることで，どのような情報を得ることができるのかを検討する．これ
らの情報を組み合わせることは個人を特定するにあたり脅威となる可能性があ
る．仮に，今回述べた情報を組み合わせることが可能になれば，ネットワーク
における個人をほぼ特定することができるようになる．もちろん，今回挙げた
3つの情報だけではなく，それらの情報を取得するにあたり，利用した情報す
べてを利用することでホストを利用するユーザを直接特定できる．


\section{まとめ}
本章では，ユーザのプライバシを脅かせる情報について3つの手法を提示した．
まず，パケットのヘッダ情報だけをもとにユーザのプロファイルを作成する手法，
ファイル共有時のmDNSプロトコルに利用される共有ホスト
名，NetBIOSのNetBIOS名を利用して，ホスト利用者の特定や実生活のリズムや
位置情報を取得する手法，Bluetooth探索におけるデバイスアドレスや名前を利
用して追跡する手法の3つである．第\ref{evaluation}章ではこれらの手法を実
際に検証する．



%%% Local Variables:
%%% mode: japanese-latex
%%% TeX-master: "../nakajima_bthesis"
%%% End:
